#!/bin/bash
#    Docker - List Volume Maps


ROLLBACK_IFS="${IFS}";
IFS=$'\n'; # Set the global for-loop delimiter to newlines (ignore spaces)

clear;
echo "";
echo "Docker - Listing Active Volume-Maps...";
echo "------------------------------------------------------------";
echo "";
# ------------------------------------------------------------
#
# Expanded using variable replacement:
#

TEXT_RESET='\e[0m';
TEXT_TEAL='\033[0;96m';
TEXT_RED='\033[0;31m'; # 
TEXT_COLORLESS='\033[0m'; # No Color

test -n "$(docker --version | grep 'Docker version' 2>/dev/null)" && is_docker_installed=1 || is_docker_installed=0;
if [ "${is_docker_installed}" -eq 1 ]; then

	docker inspect \
	--format='{{println}}{{.Config.Image}}  (Image) {{range .Mounts}}{{println}}|{{println}}|→ 📁 {{.Source}}  (Host){{println}}|   ↳ {{.Destination}}  (Container){{end}}' \
	$(docker ps --quiet) \
	| while read EACH_VOLMAP
	do
		test -n "$(echo ${EACH_VOLMAP} | grep '^.*Container.*$' 2>/dev/null;)" && echo -e "${TEXT_TEAL}${EACH_VOLMAP}${TEXT_RESET}" || echo "${EACH_VOLMAP}";
	done;


else
	echo "Docker is NOT installed";


fi;
echo "";
echo "------------------------------------------------------------";
echo "";

IFS="${ROLLBACK_IFS}"; # Restore the global for-loop delimiter to whatever the value was at the start of this script's runtime

# ------------------------------------------------------------
#  Citation(s)
#
#  docs.docker.com  |  "Format command and log output"  |  https://docs.docker.com/config/formatting/
#
#  docs.docker.com  |  "docker inspect"  |  https://docs.docker.com/engine/reference/commandline/inspect/
#
#  misc.flogisoft.com  |  "Bash tips: Colors and formatting (ANSI/VT100 Control sequences)"  |  https://misc.flogisoft.com/bash/tip_colors_and_formatting
#
# ------------------------------------------------------------

# "$(echo ${EACH_VOLMAP} | grep '^.*Destination.*$' 2>/dev/null;)"