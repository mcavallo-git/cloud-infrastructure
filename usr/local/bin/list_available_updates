#!/bin/bash
#
# LOCAL_BIN="/usr/local/bin/list_available_updates" && echo "" > "${LOCAL_BIN}" && vi "${LOCAL_BIN}" && chmod 0755 "${LOCAL_BIN}";
#
# ------------------------------------------------------------

if [ -n "$(which yum 2>'/dev/null';)" ]; then
	# ------------------------------------------------------------
	# Get Installed Packages
	#
	YUM_LIST_INSTALLED=$(yum list installed | grep -v '^Loaded' | grep -v '^Installed Packages';);
	# ------------------------------------------------------------
	# Get Available Packages
	#
	YUM_LIST_UPDATES=$(yum list updates | grep -v '^Loaded' | grep -v '^Updated Packages';);
	#
	# ------------------------------------------------------------
	# Table Header
	#
	if [ -z "${COLUMNS}" ]; then
		COLUMNS=100;
	fi;
	MAX_CHARS=$((${COLUMNS}/3));
	HEADER=$(printf "%-${MAX_CHARS}s" "Name")$(printf "%-${MAX_CHARS}s" "Version-Installed")$(printf "%-${MAX_CHARS}s" "Version-Available");
	echo -e "${HEADER}\n";
	printf "%${COLUMNS}s" | tr " " "-";
	echo "";
	# ------------------------------------------------------------
	# Table Body
	#
	echo "${YUM_LIST_UPDATES}" | while read -r -d $'\n' EACH_LINE; do
		EACH_PKG_NAME="$(echo "${EACH_LINE}" | awk '{print $1}' 2>'/dev/null';)";
		EACH_VER_INSTALD=$(echo "${YUM_LIST_INSTALLED}" | grep "^${EACH_PKG_NAME} " | awk '{print $2}' | tail -n 1 2>'/dev/null';);
		EACH_VER_UPDATES="$(echo "${EACH_LINE}" | awk '{print $2}' | tail -n 1 2>'/dev/null';)";
		if [ -n "${EACH_VER_UPDATES}" ] && [ -n "${EACH_VER_INSTALD}" ]; then
			PACKAGE_INFO=$(printf "%-${MAX_CHARS}s" "${EACH_PKG_NAME}")$(printf "%-${MAX_CHARS}s" "${EACH_VER_INSTALD}")$(printf "%-${MAX_CHARS}s" "${EACH_VER_UPDATES}");
			echo "${PACKAGE_INFO}";
		fi;
	done;
fi;


# ------------------------------------------------------------
#
# Citation(s)
#
#   stackoverflow.com  |  "How can I repeat a character in Bash?"  |  https://stackoverflow.com/a/5349796
#
# ------------------------------------------------------------